CREATE VIEW [cus].[v_OPEN_SALES_ORDER]
AS

    SELECT
        CAST(RTRIM(S102.SOPNUMBE) AS NVARCHAR(128))     AS [SALES_ORDER_NO],
        CAST(CONCAT(RTRIM(S102.ITEMNMBR), ' - ', S102.[Company]) AS NVARCHAR(255))     AS [ITEM_NO],
        CAST(S102.LOCNCODE AS NVARCHAR(255))     AS [LOCATION_NO],
        SUM(CAST(S102.QUANTITY AS DECIMAL(18,4)))     AS [QUANTITY],
        CAST(S101.CUSTNMBR AS NVARCHAR(255))     AS [CUSTOMER_NO],
        CAST(S101.REQSHIPDATE AS DATE)           AS [DELIVERY_DATE],
        S102.[Company]
    FROM
        [cus].[SOP10200] S102
    LEFT JOIN
        [cus].[SOP10100] S101 ON S102.SOPNUMBE = S101.SOPNUMBE AND S102.SOPTYPE = S101.SOPTYPE
	GROUP BY
		S102.SOPNUMBE, S102.ITEMNMBR, S102.LOCNCODE, S101.CUSTNMBR, S101.REQSHIPDATE, S102.[Company]
	HAVING SUM(CAST(S102.QUANTITY AS DECIMAL(18, 4))) <> 0

